<link href="../../../polymer-elements/polymer-grid-layout/polymer-grid-layout.html" rel="import">
<link href="../../../polymer-elements/polymer-list/polymer-grid.html" rel="import">
<link href="../../../polymer-ui-elements/polymer-ui-sidebar-menu/polymer-ui-sidebar-menu.html" rel="import">
<link href="../../../polymer-ui-elements/polymer-ui-menu-item/polymer-ui-menu-item.html" rel="import">
<link href="../../../polymer-ui-elements/polymer-ui-icon-button/polymer-ui-icon-button.html" rel="import">
<link href="../../../polymer-ui-elements/polymer-ui-accordion/polymer-ui-accordion.html" rel="import">

<link rel="import" href="../../../projects/pica/components/pi-feed-aggregator.html"/>
<link rel="import" href="../../../projects/pica/components/pi-items-view.html"/>


<polymer-element name="slide-show">
  <template>
    <style>
      @host {
        :scope; {
          display: block;
        }
      }
      
      #sidebar {
        width: 248px;
      }
      #otherbar {
        padding: 16px;
        background-color: #282828;
        color: #aaa;
      }
      #groupbar, #collections, #collectionDetail, #slideshow {
        -webkit-transition: left, opacity;
        -webkit-transition-duration: 0.3s;
        -webkit-transition-timing-function: ease-in;
      }
      #groupbar, #collections, #collectionDetail, #slideshow {
        min-width: 320px;
      }
      #groupbar, #collections {
        background-color: white;
      }
      
      #collectionDetail {
        overflow: auto;
      }
    </style>

    <polymer-grid-layout nodes="{{nodes}}" layout="{{layout}}"></polymer-grid-layout>

    <polymer-ui-toolbar id="groupbar">
      <polymer-ui-icon-button icon="menu" on-tap="sidebarToggleAction"></polymer-ui-icon-button>
      <span flex>Slideshow</span>
      <polymer-ui-icon-button icon="grid" on-tap="gridAction"></polymer-ui-icon-button>
    </polymer-ui-toolbar>

    <panel id="collections">
      <pi-feed-aggregator count="200" feed="[{'feed': 'http://www.theverge.com/rss/index.xml'}]" entries="{{verge}}"></pi-feed-aggregator>
      <pi-items-view view="topics" layout="grid" items="{{verge}}"></pi-items-view>
<!--      <polymer-ui-accordion id="accordion">
         for each group 
        <template repeat="{{collection in collections}}">
          <polymer-ui-collapsible>
             <div class="polymer-ui-collapsible-header">{{collection.header}}</div>
            <template if="{{grid}}">
              <polymer-grid style="position: relative; height: 239px;"></polymer-grid>
            </template>
            <template if="{{!grid}}">
              <template repeat="{{collection.contacts}}">
                <div>{{}}</div>
              </template>  
            </template>
          </polymer-ui-collapsible>
        </template>
      </polymer-ui-accordion>-->
    </panel>

    <panel id="collectionDetail">
      <pi-feed-aggregator count="200" feed="[{'feed': 'http://feeds.feedburner.com/indieshuffle'}]" entries="{{indie}}"></pi-feed-aggregator>
      <pi-items-view view="topics" layout="grid" items="{{indie}}"></pi-items-view>
    </panel>

    <panel id="slideshow">
      Slideshow
      <pi-feed-aggregator count="200" feed="[{'feed': 'http://feeds.feedburner.com/hypebeast/feed'}]" entries="{{hypebeast}}"></pi-feed-aggregator>
      <pi-items-view view="topics" layout="grid" items="{{hypebeast}}"></pi-items-view>
    </panel>
  </template>
  <script>
    Polymer('slide-show', {
      collections: [
        {header: 'Favorites', contacts: ["John", "James", "Jingleheimer", "Schmidt"]},
        {header: 'Near By', contacts: ["John", "James", "Jingleheimer", "Schmidt"]},
        {header: 'Recent', contacts: ["John", "James", "Jingleheimer", "Schmidt"]},
        {header: 'All', contacts: ["John", "James", "Jingleheimer", "Schmidt"]}
      ],
      pages: [[
        [1],
        [2],
        [2]
      ], [
        [1],
        [3],
        [3]
      ], [
        [1],
        [4]
      ]],
      page: 0,
      selectedNav: 0,
      grid: false,
      ready: function() {
        this.nodes = [
          this.$.groupbar, this.$.collections, this.$.collectionDetail,
          this.$.slideshow
        ];
        this.pageChanged();
      },
      gridAction: function() {
        this.grid = !this.grid;
        /*
        var groups = this.groups.slice(0);
        this.groups = null;
        this.async(function() {
          this.groups = groups;
        });
        */
      },
      pageChanged: function() {
        this.layout = this.pages[this.page];
      },
      sidebarToggleAction: function() {
        this.page = (this.page + 1) % this.pages.length;
      },
      exploreAction: function() {
        this.page = 1;
      },
      meAction: function() {
        this.selectedNav = 0;
        this.page = 3;
      },
      selectContact: function() {
        this.selectedNav = 0;
        this.page = 3;
      },
      selectedNavChanged: function() {
        //this.page = this.selectedNav * 2 + 1;
      }
    });
  </script>
</polymer-element>
